# docker/airflow/.env
# Airflow 기본 설정
AIRFLOW_UID=50000
AIRFLOW_GID=0

# 데이터베이스 설정 (PostgreSQL - Airflow 메타데이터)
POSTGRES_USER=airflow
POSTGRES_PASSWORD=airflow
POSTGRES_DB=airflow

# Memory Forest MySQL 설정 (init.sql과 일치)
DB_HOST=mysql-db
DB_NAME=memory_forest
DB_USER=kcc
DB_PASSWORD=kcc
DB_PORT=3306

# AI 서비스 설정
AI_SERVICE_URL=http://ai-service:8000
AI_SERVICE_TIMEOUT=60
AI_SERVICE_MAX_RETRIES=3
AI_SERVICE_RETRY_DELAY=5

# 컴팩트 DAG 전용 배치 처리 설정
RETRY_GAMES_BATCH_SIZE=20
MODEL_TRAINING_BATCH_SIZE=50
MAX_CONCURRENT_REQUESTS=5

# 기존 배치 처리 설정 (호환성 유지)
BATCH_SIZE_PENDING=30
BATCH_SIZE_ERROR=20
BATCH_SIZE_SUMMARY=100

# 모델 관리 설정
MODEL_PATH=/opt/airflow/models/word2vec_custom.model
BACKUP_MODEL_PATH=/opt/airflow/models/word2vec_custom_backup.model
TRAINING_DATA_PATH=/opt/airflow/data/training
MISSING_WORDS_MARKER=%모델%

# 모니터링 설정
ERROR_THRESHOLD=15.0
PENDING_THRESHOLD=100
DAILY_REPORT_HOUR=9
HEALTH_CHECK_INTERVAL=30

# 로깅 설정
LOG_LEVEL=INFO
MAX_LOG_SIZE_MB=100

# 네이버 API (기존 DAG 호환성)
NAVER_CLIENT_ID=xaKw7jRi9oNo8orrCBYB
NAVER_CLIENT_SECRET=TQtRJrhWU9

# Airflow 최적화 설정
AIRFLOW__CORE__EXECUTOR=LocalExecutor
AIRFLOW__CORE__LOAD_EXAMPLES=false
AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION=false
AIRFLOW__CORE__MAX_ACTIVE_RUNS_PER_DAG=1
AIRFLOW__CORE__MAX_ACTIVE_TASKS_PER_DAG=4

# 로깅 설정
AIRFLOW__LOGGING__LOGGING_LEVEL=INFO
AIRFLOW__LOGGING__FAB_LOGGING_LEVEL=WARNING

# 웹서버 설정
AIRFLOW__WEBSERVER__EXPOSE_CONFIG=true
AIRFLOW__WEBSERVER__EXPOSE_HOSTNAME=true
AIRFLOW__WEBSERVER__EXPOSE_STACKTRACE=true

# 컴팩트 DAG 스케줄 설정 (필요시 조정 가능)
RETRY_SCHEDULE=*/10 * * * *
TRAINING_SCHEDULE=0 3 * * *